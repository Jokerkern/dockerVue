(function(e){function t(t){for(var n,r,s=t[0],i=t[1],c=t[2],h=0,p=[];h<s.length;h++)r=s[h],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&p.push(o[r][0]),o[r]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);u&&u(t);while(p.length)p.shift()();return l.push.apply(l,c||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],n=!0,s=1;s<a.length;s++){var i=a[s];0!==o[i]&&(n=!1)}n&&(l.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},o={app:0},l=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=i;l.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"191b":function(e,t,a){"use strict";a("af89")},3357:function(e,t,a){},"3c79":function(e,t,a){"use strict";a("ccbd")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},l=[],r=(a("caad"),a("2532"),a("ac1f"),a("1276"),a("fb6a"),{name:"app",data:function(){return{webSocket:null,logArr:[]}},created:function(){this.initWebSocket()},destroyed:function(){this.webSocket.close()},beforeDestroy:function(){},close:function(){},methods:{initWebSocket:function(){var e=localStorage.getItem("ip_address"),t=localStorage.getItem("port");console.log(e,t),this.webSocket=new WebSocket("ws://"+e+":"+t),this.webSocket.onopen=this.onOpen,this.webSocket.onmessage=this.onMessage,this.webSocket.onerror=this.onError,this.webSocket.onclose=this.onClose},onMessage:function(e){var t=this.cutString(e);this.logArr.includes(t.file)||(this.logArr.push(t.file),this.$store.commit("changeLog",{title:t.file,content:[]}),this.$store.commit("changeFile",{title:t.file,total:0}));var a=this.logArr.indexOf(t.file);switch(this.$store.commit("changeTotal"),this.$store.commit("changeLogContent",{logIndex:a,log:t}),this.$store.commit("changeFileTotal",a),this.$store.commit("changeMonthTotal",new Date(t.date).getMonth()),t.level){case"debug":this.$store.commit("changeLevelTotal",0);break;case"info":this.$store.commit("changeLevelTotal",1);break;case"warning":this.$store.commit("changeLevelTotal",2);break;case"error":this.$store.commit("changeLevelTotal",3);break}},cutString:function(e){var t=new String,a=new Array;t=e.data,a=t.split(" ");var n=a[0].length+a[1].length+a[2].length+a[3].length+4;return{date:a[0].slice(1,a[0].length),time:a[1].slice(0,a[1].length-1),file:a[2].slice(1,a[2].length-1),level:a[3].slice(1,a[3].length-1),message:t.slice(n)}},onOpen:function(){console.log("open")},onError:function(){console.log("error"),this.initWebSocket()},onClose:function(){console.log("close")}}}),s=r,i=a("2877"),c=Object(i["a"])(s,o,l,!1,null,null,null),u=c.exports,h=a("8c4f"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("SideMenu",{staticClass:"home-left"}),a("div",{staticClass:"home-right"},[a("el-empty",{directives:[{name:"show",rawName:"v-show",value:e.isConnected,expression:"isConnected"}],staticClass:"empty",attrs:{description:"连接不到websocket"}}),a("el-tabs",{directives:[{name:"show",rawName:"v-show",value:!e.isConnected,expression:"!isConnected"}],attrs:{type:"card"},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},e._l(e.editableTabs,(function(t){return a("el-tab-pane",{key:t.name,attrs:{label:t.title,name:t.name,align:"left"}},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-date-picker",{attrs:{"unlink-panels":"",size:"mini",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}})],1),a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},on:{change:function(a){return e.handleSearch(t)}},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1)],1)],1),a("el-table",{attrs:{data:t.content.filter((function(t){return!e.search||t.message.toLowerCase().includes(e.search.toLowerCase())})).filter((function(t){return!e.value1||new Date(t.date).getTime()-288e5>=e.value1[0].getTime()&&new Date(t.date).getTime()-288e5<=e.value1[1].getTime()})).slice((t.currentPage-1)*e.pagesize,t.currentPage*e.pagesize)}},[a("el-table-column",{attrs:{prop:"date",label:"日期",width:"250",align:"center"}}),a("el-table-column",{attrs:{prop:"time",label:"时间",width:"250",align:"center"}}),a("el-table-column",{attrs:{prop:"file",label:"文件",width:"200",align:"center"}}),a("el-table-column",{attrs:{prop:"level",label:"类别","column-key":"date",width:"200",align:"center",filters:[{text:"info",value:"info"},{text:"debug",value:"debug"},{text:"warning",value:"warning"},{text:"error",value:"error"}],"filter-method":e.filterHandler}}),a("el-table-column",{attrs:{prop:"message",label:"内容",width:"400",align:"center"}})],1),a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[5,10,20,40],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.content.filter((function(t){return!e.search||t.message.toLowerCase().includes(e.search.toLowerCase())})).filter((function(t){return!e.value1||new Date(t.date).getTime()-288e5>=e.value1[0].getTime()&&new Date(t.date).getTime()-288e5<=e.value1[1].getTime()})).length,align:"center"},on:{"size-change":e.handleSizeChange,"current-change":function(a){return e.handleCurrentChange(t,a)},"update:currentPage":function(a){return e.$set(t,"currentPage",a)},"update:current-page":function(a){return e.$set(t,"currentPage",a)}}},[e._v(" //这是显示总共有多少数据 ")])],1)})),1)],1)],1)},g=[],f=(a("99af"),a("841c"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-menu",{staticClass:"side-menu",attrs:{"default-active":e.activeIndex,router:!0,collapse:e.isCollapse,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},[a("div",{staticClass:"fold-wrapper"},[e.isCollapse?a("i",{staticClass:"el-icon-s-unfold",attrs:{title:"展开"},on:{click:function(t){e.isCollapse=!1}}}):a("i",{staticClass:"el-icon-s-fold",attrs:{title:"收缩"},on:{click:function(t){e.isCollapse=!0}}})]),a("el-menu-item",{attrs:{index:"About"}},[a("i",{staticClass:"el-icon-odometer"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("仪表板")])]),a("el-menu-item",{attrs:{index:"Home"}},[a("i",{staticClass:"el-icon-reading"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("日志")])]),a("el-menu-item",{attrs:{index:"Logorm"}},[a("i",{staticClass:"el-icon-data-line"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("数据库")])]),a("el-menu-item",{attrs:{index:"Setting"}},[a("i",{staticClass:"el-icon-setting"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("设置")])])],1)}),d=[],m={name:"SideMenu",data:function(){return{isCollapse:!1}},computed:{activeIndex:function(){return String(this.$route.query.fileType)}},watch:{isCollapse:function(e){sessionStorage.setItem("isCollapse",e)}},created:function(){this.isCollapse="true"===sessionStorage.getItem("isCollapse")}},v=m,b=(a("da1d"),Object(i["a"])(v,f,d,!1,null,"6b7dbaa9",null)),x=b.exports,S={name:"home",components:{SideMenu:x},data:function(){return{editableTabsValue:"0",editableTabs:[],tabIndex:0,logArr:[],content:[],timer:"",pagesize:10,search:"",input:"",value1:"",isConnected:!0}},created:function(){},mounted:function(){var e=this;this.timer=setInterval((function(){for(var t=e.$store.state.log,a=e.logArr.length;a<t.length;a++){e.logArr.push(t[a].title);var n=++e.tabIndex+"";e.editableTabs.push({currentPage:1,title:t[a].title,name:n,content:[]}),e.editableTabsValue=n,e.isConnected=!1}for(a=0;a<t.length;a++)e.editableTabs[a].content=[].concat(t[a].content)}),100)},beforeDestroy:function(){clearInterval(this.timer)},destroyed:function(){},methods:{handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e,t){e.currentPage=t},handleSearch:function(){this.search=this.input},filterHandler:function(e,t,a){var n=a["property"];return t[n]===e}}},w=S,y=(a("191b"),Object(i["a"])(w,p,g,!1,null,"14d45963",null)),T=y.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"about"},[a("SideMenu",{staticClass:"about-left"}),a("div",{staticClass:"about-right"},[a("el-row",{staticClass:"home",attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-card",{staticStyle:{height:"200px"},attrs:{shadow:"hover"}},[a("div",{staticClass:"total"},[a("div",[a("p",{staticStyle:{"line-height":"0px","font-size":"10px"}},[e._v("所有日志")]),a("p",{staticStyle:{"line-height":"0px","font-size":"30px"}},[e._v(" "+e._s(this.lsSqlTotal)+" ")]),a("p",{staticStyle:{color:"green"}},[e._v(" ▲"+e._s(this.lsSqlTotal-this.sqlTotal)+"("+e._s(((this.lsSqlTotal-this.sqlTotal)/1e4).toFixed(2))+"%) ")])]),a("div",{staticStyle:{border:"1px solid #000",height:"110px"}}),a("div",[a("p",{staticStyle:{"line-height":"0px","font-size":"10px"}},[e._v("缓存日志")]),a("p",{staticStyle:{"line-height":"0px","font-size":"30px"}},[e._v(" "+e._s(this.lsTotal)+" ")]),a("p",{staticStyle:{color:"green"}},[e._v(" ▲"+e._s(this.lsTotal-this.total)+"("+e._s(((this.lsTotal-this.total)/1e4).toFixed(2))+"%) ")])])])]),a("el-card",{staticStyle:{height:"300px","margin-top":"20px"},attrs:{shadow:"hover"}},[a("ve-line",{attrs:{height:"300px",data:e.chartData,colors:e.colors,extend:e.chartExtend,settings:e.chartSettings}})],1),a("el-card",{staticStyle:{height:"275px","margin-top":"20px"},attrs:{shadow:"hover"}},[a("ve-pie",{attrs:{data:e.pieData,settings:e.pieSettings,extend:e.pieExtend}})],1)],1),a("el-col",{attrs:{span:16}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticStyle:{height:"280px"}})]),a("div",{staticClass:"graph"},[a("el-card",{staticStyle:{height:"400px","margin-top":"20px"},attrs:{shadow:"hover"}},[a("ve-histogram",{attrs:{height:"400px",data:e.histogramData,settings:e.histogramSettings,extend:e.histogramExtend}})],1)],1)],1)],1)],1)],1)},k=[],_=(a("627c"),a("d3b7"),a("bc3a")),$=a.n(_),z=a("5c96"),P=a.n(z),M=void 0;function I(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new Promise((function(n,o){$.a.get(e+a,{params:t}).then((function(e){n(e.data)})).catch((function(e){o(e.data)}))}))}$.a.defaults.timeout=5e4,$.a.defaults.baseURL="/api",$.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",$.a.interceptors.request.use((function(e){return e}),(function(e){return console.log(e),Promise.reject(e)})),$.a.interceptors.response.use((function(e){if(200===e.status)return Promise.resolve(e)}),(function(e){if(e.response.status)switch(e.response.status){case 500:z["Message"].error("后台服务发生错误");break;case 401:z["Message"].error("无权限");break;case 404:z["Message"].error("当前接口不存在");break;default:return M.$message.error(e.response.message),Promise.reject(e.response)}}));var L=function(e){return I("/v1/todo/",e)},D=function(e){return I("/v1/todo/total",e)},O={name:"about",components:{SideMenu:x},data:function(){return this.colors=["#87CEFA"],this.chartExtend={series:{smooth:!1},legend:{show:!1},title:{text:"日志趋势",x:"left",y:"top",textAlign:"auto",textStyle:{color:"#000000",fontWeight:"normal",fontSize:12}}},this.chartSettings={area:!0,scale:[!0]},this.pieSettings={type:"pie"},this.pieExtend={series:{center:["30%","30%"],radius:"40%",minAngle:15},legend:{type:"scroll",orient:"vertical",show:!0,left:"70%",top:70},title:{text:"日志比例",x:"left",y:"top",textAlign:"auto",textStyle:{color:"#000000",fontWeight:"normal",fontSize:12}}},this.histogramSettings={type:"histogram"},this.histogramExtend={series:{barWidth:30},legend:{show:!1},title:{text:"日志数量",x:"left",y:"top",textAlign:"auto",textStyle:{color:"#000000",fontWeight:"normal",fontSize:12}}},{timer:"",lsTotal:0,total:1,sqlTotal:0,lsSqlTotal:0,sqlConnect:!1,chartData:{columns:["月份","日志数"],rows:[{"月份":"1","日志数":"0"},{"月份":"2","日志数":"0"},{"月份":"3","日志数":"0"},{"月份":"4","日志数":"0"},{"月份":"5","日志数":"0"}]},pieData:{columns:["key","value"],rows:[{key:"debug",value:"0"},{key:"info",value:"0"},{key:"warning",value:"0"},{key:"error",value:"0"}]},histogramData:{columns:["key","value"],rows:[]}}},mounted:function(){var e=this;D().then((function(t){e.sqlTotal=t.total,e.lsSqlTotal=t.total,0!=e.sqlTotal&&(e.sqlConnect=!0)}));var t=this;this.timer=setInterval((function(){t.sqlConnect&&D().then((function(e){t.lsSqlTotal=e.total}))}),1e4),this.timer=setInterval((function(){if(t.$store.state.total>t.lsTotal){t.lsTotal=t.$store.state.total;for(var e=new Date,a=0;a<5;a++){var n=(e.getMonth()+13-4+a)%12==0?12:(e.getMonth()+13-4+a)%12;t.$set(t.chartData.rows,a,{"月份":n+"","日志数":t.$store.state.monthTotal[n-1]+""})}for(a=0;a<4;a++)t.$set(t.pieData.rows[a],"value",t.$store.state.levelTotal[a]+"");for(a=t.histogramData.rows.length;a<t.$store.state.fileTotal.length;a++)t.histogramData.rows.push({key:t.$store.state.fileTotal[a].title,value:"0"});for(a=0;a<t.$store.state.fileTotal.length;a++)t.$set(t.histogramData.rows[a],"value",t.$store.state.fileTotal[a].total+"")}}),100)},beforeDestroy:function(){clearInterval(this.timer)}},j=O,A=(a("e76e"),a("f849"),Object(i["a"])(j,C,k,!1,null,"4a7c534a",null)),q=A.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Setting"},[a("SideMenu",{staticClass:"Setting-left"}),a("div",{staticClass:"Setting-right"},[a("el-form",{ref:"form",staticStyle:{width:"400px"},attrs:{model:e.form,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"webSocket ip"}},[a("el-input",{model:{value:e.form.ip_address,callback:function(t){e.$set(e.form,"ip_address",t)},expression:"form.ip_address"}})],1),a("el-form-item",{attrs:{label:"webSocket 端口"}},[a("el-input",{model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确定")]),a("el-button",[e._v("重置")])],1)],1)],1)],1)},W=[],F=(a("5319"),{name:"Setting",components:{SideMenu:x},data:function(){return{form:{ip_address:"",port:""}}},mounted:function(){this.form.ip_address=localStorage.getItem("ip_address")?localStorage.getItem("ip_address"):"127.0.0.1",this.form.port=localStorage.getItem("port")?localStorage.getItem("port"):"9002"},methods:{onSubmit:function(){localStorage.clear(),localStorage.setItem("ip_address",this.form.ip_address),localStorage.setItem("port",this.form.port),this.$store.commit("clear"),this.$router.replace("/About"),location.reload()}}}),H=F,V=(a("3c79"),Object(i["a"])(H,E,W,!1,null,"5ef3fb2d",null)),J=V.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Logorm"},[a("SideMenu",{staticClass:"Logorm-left"}),a("div",{staticClass:"Logorm-right"},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"submit"},on:{click:e.check}},[e._v("确认")])],1)],1),a("el-table",{attrs:{data:e.message.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize)}},[a("el-table-column",{attrs:{prop:"time",label:"时间",width:"250",align:"center"}}),a("el-table-column",{attrs:{prop:"logger",label:"文件",width:"250",align:"center"}}),a("el-table-column",{attrs:{prop:"level",label:"类别","column-key":"date",width:"200",align:"center",filters:[{text:"info",value:"info"},{text:"debug",value:"debug"},{text:"warning",value:"warning"},{text:"error",value:"error"}],"filter-method":e.filterHandler}}),a("el-table-column",{attrs:{prop:"log",label:"内容",width:"400",align:"center"}})],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20,40],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.message.length,align:"center"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}},[e._v(" //这是显示总共有多少数据 ")])],1)],1)},R=[],U={name:"Logorm",components:{SideMenu:x},data:function(){return{options:[{value:"file",label:"文件"},{value:"level",label:"级别"},{value:"log",label:"内容"}],value:"log",input:"",message:[],currentPage:1,pagesize:10}},methods:{check:function(){var e=this;switch(this.value){case"file":L({file:this.input}).then((function(t){e.message=[],e.message.push.apply(e.message,t.data)}));break;case"level":L({level:this.input}).then((function(t){e.message=[],e.message.push.apply(e.message,t.data)}));break;case"log":L({log:this.input}).then((function(t){e.message=[],e.message.push.apply(e.message,t.data)}));break}},filterHandler:function(e,t,a){var n=a["property"];return t[n]===e},handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.currentPage=e}}},B=U,G=(a("e95f"),Object(i["a"])(B,N,R,!1,null,"75a08c24",null)),K=G.exports;n["default"].use(h["a"]);var Q=[{path:"/",name:"Aboud",component:q},{path:"/About",name:"About",component:q},{path:"/Home",name:"Home",component:T},{path:"/Logorm",name:"Logorm",component:K},{path:"/Setting",name:"Setting",component:J}],X=new h["a"]({base:"",routes:Q}),Y=X,Z=a("2f62");a("54ba");n["default"].use(Z["a"]);var ee=new Z["a"].Store({state:{log:[],total:0,monthTotal:[0,0,0,0,0,0,0,0,0,0,0,0],levelTotal:[0,0,0,0],fileTotal:[]},getters:{log:function(e){return e.log},total:function(e){return e.total},monthTotal:function(e){return e.monthTotal},levelTotal:function(e){return e.levelTotal},fileTotal:function(e){return e.fileTotal}},mutations:{changeLog:function(e,t){e.log.push(t)},changeLogContent:function(e,t){e.log[t.logIndex].content.unshift(t.log)},changeTotal:function(e){e.total+=1},changeMonthTotal:function(e,t){e.monthTotal[t]++},changeLevelTotal:function(e,t){e.levelTotal[t]++},changeFile:function(e,t){e.fileTotal.push(t)},changeFileTotal:function(e,t){e.fileTotal[t].total++},clear:function(e){e.log=[],e.total=0,e.monthTotal=[0,0,0,0,0,0,0,0,0,0,0,0],e.levelTotal=[0,0,0,0],e.fileTotal=[]}},actions:{},modules:{}}),te=(a("0fae"),a("2819")),ae=a.n(te);n["default"].config.productionTip=!1,n["default"].use(P.a),n["default"].use(ae.a),new n["default"]({router:Y,store:ee,render:function(e){return e(u)}}).$mount("#app")},6424:function(e,t,a){},"847d":function(e,t,a){},"91aa":function(e,t,a){},af89:function(e,t,a){},ccbd:function(e,t,a){},da1d:function(e,t,a){"use strict";a("847d")},e76e:function(e,t,a){"use strict";a("91aa")},e95f:function(e,t,a){"use strict";a("6424")},f849:function(e,t,a){"use strict";a("3357")}});
//# sourceMappingURL=app.1d7c5633.js.map